<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>html5UploadImg</title>
  <script src="./jquery-1.11.1.min.js"></script>
  <script src="../dist/html5UploadImg.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
    }
    input {
      margin: 10px 0 0 10px;
    }
    div[class^="box_"] {
      margin: 10px;
      padding: 10px;
      font-size: 14px;
      line-height: 1.5em;
      border: 2px dashed #ccc;
    }
    span {
      color: red;
    }
    img {
      max-width: 100%;
      margin-top: 10px;
    }
  </style>
  <script>
    var j = 1;

    $(function () {
      $('input').on('change', function (e) {
        var
          i = 0,
          files = e.target.files,
          len = files.length,
          notSupport = false;

        // 循环多张图片，需要for循环和notSupport变量支持
        for (; i < len; i++) {
          if (!notSupport) {
            new html5UploadImg(files[i], {
              done: function (base64, file) { // 这里是异步回调，i的顺序不能保证
                insertImg(file, j); // 原图
                insertImg(base64, j++); // 处理后
                // ...
              },
              notSupport: function() {
                notSupport = true;
                // ...
              }
            });
          }
        }
      })
    });

    function insertImg(file, j) {
      var
        img = new Image(),
        title, src, size, base;

      if (typeof file === 'object') {
        title = '前';
        size = file.size;
        src = URL.createObjectURL(file);
        base = 1024;
      } else {
        title = '后';
        size = file.length;
        src = file;
        base = 1333;
      }

      if (!$('.box_' + j).length) {
        $('#box').prepend('<div class="box_' + j + '" />'); // 逆序，方便demo多次上传预览
      }

      img.onload = function() {
        $('.box_' + j).prepend(img).prepend('<p>图片' + j + '，处理' + title + '</p><p>质量约：<span>' + (size / base).toFixed(2) + 'KB</span>' + '&nbsp;&nbsp;&nbsp;&nbsp;尺寸：<span>' + this.width + '*' + this.height + '</span></p>');
      };

      img.src = src;

      file = null; // 处理完后记得清缓存
    };
  </script>
</head>
<body>
<input type="file" multiple="multiple"/>
<div id="box"></div>
</body>
</html>